# This file is generated automatically

FROM node:10-stretch-slim

# Make APT non-interactive
RUN echo 'APT::Get::Assume-Yes "true";' > /etc/apt/apt.conf.d/99semaphore
RUN echo 'DPkg::Options "--force-confnew";' >> /etc/apt/apt.conf.d/99semaphore
ENV DEBIAN_FRONTEND=noninteractive

# Install Packages
RUN mkdir -p /usr/share/man/man1
RUN apt-get update
RUN echo 'Acquire::Check-Valid-Until no;' >> /etc/apt/apt.conf
RUN if grep -q jessie /etc/apt/sources.list ;then echo 'deb http://cdn-fastly.deb.debian.org/debian/ jessie main'>/etc/apt/sources.list; echo 'deb-src http://cdn-fastly.deb.debian.org/debian/ jessie main'>>/etc/apt/sources.list; echo 'deb http://security.debian.org/ jessie/updates main'>>/etc/apt/sources.list;echo 'deb-src http://security.debian.org/ jessie/updates main'>>/etc/apt/sources.list;fi
RUN apt-get install -y \
    git \ 
    mercurial \ 
    xvfb \ 
    vim \ 
    apt \ 
    locales \ 
    sudo \ 
    apt-transport-https \ 
    ca-certificates \ 
    openssh-client \ 
    software-properties-common \ 
    build-essential \ 
    tar \ 
    lsb-core \ 
    lsb-release \ 
    gzip \ 
    parallel \ 
    net-tools \ 
    netcat \ 
    unzip \ 
    zip \ 
    bzip2 \ 
    lftp \ 
    gnupg \ 
    curl \ 
    wget \ 
    build-essential \ 
    tree
RUN ln -sf /usr/share/zoneinfo/Etc/UTC /etc/localtime
RUN locale-gen C.UTF-8 || true
ENV LANG=C.UTF-8

# Install Docker
ENV DOCKER_COMPOSE=1.23.2
RUN set -ex \
    && export DOCKER_VERSION=$(curl --silent --fail --retry 3 https://download.docker.com/linux/static/stable/x86_64/ | grep -o -e 'docker-[.0-9]*\.tgz' | sort -r | head -n 1) \ 
    && DOCKER_URL="https://download.docker.com/linux/static/stable/x86_64/${DOCKER_VERSION}" \ 
    && echo Docker URL: $DOCKER_URL \ 
    && curl --silent --show-error --location --fail --retry 3 --output /tmp/docker.tgz "${DOCKER_URL}" \ 
    && ls -lha /tmp/docker.tgz \ 
    && tar -xz -C /tmp -f /tmp/docker.tgz \ 
    && mv /tmp/docker/* /usr/bin \ 
    && rm -rf /tmp/docker /tmp/docker.tgz \ 
    && which docker \ 
    && (docker version || true)

# Install Compose
RUN wget -q \
    https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE}/docker-compose-`uname -s`-`uname -m` -O /usr/local/bin/docker-compose \ 
    && chmod +x /usr/local/bin/docker-compose \ 
    && docker-compose --version

# Entrypoint
CMD ["/bin/sh"]
